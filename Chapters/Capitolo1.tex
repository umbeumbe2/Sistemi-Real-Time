\chapter{Esercizi Prima Intercorso}



\begin{Esercizio1}
Dato l'insieme di task periodici in tabella, in cui, per 
ogni task si ipotizza l'uso di al massimo 4 sezioni critiche 
sui semafori $S_1$, $S_2$, $S_3$, ed $S_4$ ed in cui i valori 
nelle colonne $S_i$ rappresentano le durate massime 
delle rispettive sezioni critiche, si determini 
se l'insieme è schedulabile con RM e priority 
inheritance, utilizzando il test di Liu e Layland

\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $T_i$ & $C_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ \\
\hline
$J_1$ & 15 & 70 & 2 & 4 & 5 & 0 \\
\hline
$J_2$ & 6 & 20 & 0 & 2 & 0 & 4 \\
\hline
$J_3$ & 10 & 135 & 1 & 3 & 0 & 5 \\
\hline
$J_4$ & 5 & 30 & 3 & 0 & 0 & 1 \\
\hline
\end{tabular}
\label{tab:task_periodici}
\end{table}

\end{Esercizio1}


\begin{Esercizio2}

Consideriamo i seguenti task periodici:

\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ \\
\hline
$J_1$ & 5 & 28 & 0 & 0 & 2 & 1 & 0 \\
\hline
$J_2$ & 3 & 16 & 1 & 0 & 0 & 2 & 0 \\
\hline
$J_3$ & 4 & 60 & 1 & 0 & 2 & 3 & 0 \\
\hline
$J_4$ & 10 & 40 & 3 & 4 & 0 & 0 & 1 \\
\hline
$J_5$ & 10 & 100 & 0 & 2 & 1 & 0 & 4 \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\end{table}

Per prima cosa bisogna riscrivere i task in ordine di priorità,
in cui un task con periodo minore (quindi con deadline minore)
ha priorità maggiore rispetto ad un task con periodo maggiore.
Dunque la nuova tabella diventa:

\begin{table}[h]
\centering
\caption{Task ordinati per priorità}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ \\
\hline
$J_2$ & 3 & 16 & 1 & 0 & 0 & 2 & 0 \\
\hline
$J_1$ & 5 & 28 & 0 & 0 & 2 & 1 & 0 \\
\hline
$J_4$ & 10 & 40 & 3 & 4 & 0 & 0 & 1 \\
\hline
$J_3$ & 4 & 60 & 1 & 0 & 2 & 3 & 0 \\
\hline
$J_5$ & 10 & 100 & 0 & 2 & 1 & 0 & 4 \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\end{table}

Calcoliamo i \(B_i\). Partiamo da \(B_2\),
ricordando che vale:
\[ B_2 = \min \left\{B_{1}^{l} , B_{2}^{s}\right\} \]
Calcoliamo \(B_{1}^{l}\).
Notiamo per prima cosa che \(C(J_{2}) = P_{2}\),
andiamo quindi a selezionare solo i semafori 
con \(C(S_{i}) \ge P_{2}\), cioè \(S_1\) e \(S_4\).
Per vederlo graficamente dobbiamo selezionare solo 
i semafori che hanno almeno un elemento diverso da 0 
sopra la linea rossa orizzontale che rappresenta la priorità
\(J_{2}\):

\begin{table}[h]
\centering
\caption{Task ordinati per priorità}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ \\
\hline
$J_2$ & 3 & 16 & 1 & 0 & 0 & 2 & 0 \\
\arrayrulecolor{red}\hline
\arrayrulecolor{black}
$J_1$ & 5 & 28 & 0 & 0 & 2 & 1 & 0 \\
\hline
$J_4$ & 10 & 40 & 3 & 4 & 0 & 0 & 1 \\
\hline
$J_3$ & 4 & 60 & 1 & 0 & 2 & 3 & 0 \\
\hline
$J_5$ & 10 & 100 & 0 & 2 & 1 & 0 & 4 \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\end{table}

Dunque i semafori che hanno almeno un elemento diverso da 
0 sono \(S_{1}\) e \(S_{4}\):


\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & \cellcolor{blue!20}$S_1$ & $S_2$ & $S_3$ & \cellcolor{blue!20}$S_4$ & $S_5$ \\
\hline
$J_2$ & 3 & 16 & \cellcolor{blue!20}1 & 0 & 0 & \cellcolor{blue!20}2 & 0 \\
\arrayrulecolor{red}\hline
\arrayrulecolor{black}
$J_1$ & 5 & 28 & \cellcolor{blue!20}0 & 0 & 2 & \cellcolor{blue!20}1 & 0 \\
\hline
$J_4$ & 10 & 40 & \cellcolor{blue!20}3 & 4 & 0 & \cellcolor{blue!20}0 & 1 \\
\hline
$J_3$ & 4 & 60 & \cellcolor{blue!20}1 & 0 & 2 & \cellcolor{blue!20}3 & 0 \\
\hline
$J_5$ & 10 & 100 & \cellcolor{blue!20}0 & 2 & 1 & \cellcolor{blue!20}0 & 4 \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\end{table}

Ora andiamo a selezionare di questi semafori solo le 
righe sono la riga di \(J_{2}\):


\begin{table}[!h]
\centering
\caption{Task ordinati per priorità}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ \\
\hline
$J_2$ & 3 & 16 & 1 & 0 & 0 & 2 & 0 \\
\arrayrulecolor{red}\hline
\arrayrulecolor{black}
$J_1$ & 5 & 28 & \cellcolor{blue!20}0 & 0 & 2 & \cellcolor{blue!20}1 & 0 \\
\hline
$J_4$ & 10 & 40 & \cellcolor{blue!20}3 & 4 & 0 & \cellcolor{blue!20}0 & 1 \\
\hline
$J_3$ & 4 & 60 & \cellcolor{blue!20}1 & 0 & 2 & \cellcolor{blue!20}3 & 0 \\
\hline
$J_5$ & 10 & 100 & \cellcolor{blue!20}0 & 2 & 1 & \cellcolor{blue!20}0 & 4 \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\end{table} 

Ora per calcolare \(B_{2}^{l}\) per ogni riga sotto 
\(J_{2}\) andiamo 
a fare il massimo solo tra gli elementi delle colonne
dei semafori selezionati, cioè \(S_{1}\) e \(S_{4}\):


\begin{table}[!h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ & $\max$ \\
\hline
$J_2$ & 3 & 16 & 1 & 0 & 0 & 2 & 0 & \\
\arrayrulecolor{red}\hline
\arrayrulecolor{black}
$J_1$ & 5 & 28 & \cellcolor{blue!20}0 & 0 & 2 & \cellcolor{blue!20}1 & 0 & 1 \\
\hline
$J_4$ & 10 & 40 & \cellcolor{blue!20}3 & 4 & 0 & \cellcolor{blue!20}0 & 1 & 3 \\
\hline
$J_3$ & 4 & 60 & \cellcolor{blue!20}1 & 0 & 2 & \cellcolor{blue!20}3 & 0 & 3 \\
\hline
$J_5$ & 10 & 100 & \cellcolor{blue!20}0 & 2 & 1 & \cellcolor{blue!20}0 & 4 & 0 \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\caption{Massimi per calcolo \(B_{i}^{l}\)}

\end{table}

\(B_{2}^{l}\) è dato dalla somma dei massimi:
\[ B_{2}^{l} = 1 + 3 + 3 + 0 = 7 \]




Ora calcoliamo \(B_{2}^{s}\). Per calcolarlo dobbiamo
considerare come prima tutti i semafori per cui si ha 
\(C(S_{i}) \ge P_{2}\), che come prima sono solo
 \(S_{1}\) e \(S_{4}\). Di questi semafori 
 consideriamo solo le righe che stanno sotto \(J_{2}\):


\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ \\
\hline
$J_2$ & 3 & 16 & 1 & 0 & 0 &2 & 0 \\
\arrayrulecolor{red}\hline
\arrayrulecolor{black}
$J_1$ & 5 & 28 & \cellcolor{blue!20}0 & 0 & 2 & \cellcolor{blue!20}1 & 0 \\
\hline
$J_4$ & 10 & 40 & \cellcolor{blue!20}3 & 4 & 0 & \cellcolor{blue!20}0 & 1 \\
\hline
$J_3$ & 4 & 60 & \cellcolor{blue!20}1 & 0 & 2 & \cellcolor{blue!20}3 & 0 \\
\hline
$J_5$ & 10 & 100 & \cellcolor{blue!20}0 & 2 & 1 & \cellcolor{blue!20}0 & 4 \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\end{table}
Ora per ogni semaforo selezionato (dunque per ogni colonna
selezionata)
andiamo a fare il massimo tra gli elementi del semaforo
(aggiungiamo una riga per fare vedere i massimi):


\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\(\tau\) & $C_i$ & $T_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ \\
\hline
$J_2$ & 3 & 16 & 1 & 0 & 0 & 2 & 0 \\
\arrayrulecolor{red}\hline
\arrayrulecolor{black}
$J_1$ & 5 & 28 & \cellcolor{blue!20}0 & 0 & 2 & \cellcolor{blue!20}1 & 0 \\
\hline
$J_4$ & 10 & 40 & \cellcolor{blue!20}3 & 4 & 0 & \cellcolor{blue!20}0 & 1 \\
\hline
$J_3$ & 4 & 60 & \cellcolor{blue!20}1 & 0 & 2 & \cellcolor{blue!20}3 & 0 \\
\hline
$J_5$ & 10 & 100 & \cellcolor{blue!20}0 & 2 & 1 & \cellcolor{blue!20}0 & 4 \\
\hline
max & & & 3 & & & 3 & \\
\hline
\end{tabular}
\label{tab:task_periodici_esercizio}
\end{table}

\(B_{2}^{s}\) è dato dalla somma dei massimi:
\[ B_{2}^{s} = 3 + 3 = 6 \]

Dunque \(B_{2}\) sarà:
\[ B_{2} = \min \left\{B_{2}^{l} , B_{2}^{s}\right\} =
 \min \left\{7 , 6\right\} = 6 \]

\end{Esercizio2}




\begin{Esercizio3}

Dato l'insieme di task in tabella, in cui, 
per ogni task si riporta la richiesta
 di utilizzo massima di 4 risorse R1, R2, R3, ed 
 R4 disponibili in un massimo di 4, 2, 3 e 1 unità, 
 si calcoli il ceiling C(m) per tutte e tre le risorse, 
 al variare del numero di risorse disponibili. 
 Nel caso in cui siano correttamente disponibili 3
  unità di R1, 1 unità di R2, 0 unità di R3 e 1 
  unità di R4. Quale sarà il valore assunto dal 
  ceiling del sistema 

  \begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|}
\hline
& $D_i$ & $\mu_{R1}$ & $\mu_{R2}$ & $\mu_{R3}$ & $\mu_{R4}$ \\
\hline
$J_1$ & 35 & 4 & 1 & 0 & 1 \\
\hline
$J_2$ & 10 & 3 & 1 & 0 & 0 \\
\hline
$J_3$ & 140 & 2 & 0 & 3 & 1 \\
\hline
$J_4$ & 80 & 1 & 2 & 2 & 0 \\
\hline
\end{tabular}
\caption{Richieste di task e disponibilità di risorse}
\end{table}

\end{Esercizio3}


\begin{Esercizio4}

Dato l'insieme di task periodici in tabella, in cui, per ogni task si ipotizza 
l'uso di al massimo 4 sezioni critiche sui semafori $S_1$, $S_2$, $S_3$, ed $S_4$ 
ed in cui i valori nelle colonne $S_i$ rappresentano le durate massime delle 
rispettive sezioni critiche, si determini se l'insieme è schedulabile con EDF 
e Stack Resource Policy (SRP) con il test di Liu e Layland, assumendo che i task 
con periodo minore abbiano maggior livello di preemption. I tempi di bloccaggio 
possono essere calcolati con il metodo che si adotta per il priority ceiling.

\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
G & $T_i$ & $C_i$ & $S_1$ & $S_2$ & $S_3$ & $S_4$ \\
\hline
$J_1$ & 5 & 25 & 4 & 0 & 0 & 0 \\
\hline
$J_2$ & 12 & 150 & 0 & 5 & 0 & 6 \\
\hline
$J_3$ & 4 & 16 & 0 & 2 & 0 & 0 \\
\hline
$J_4$ & 2 & 10 & 0 & 0 & 1 & 0 \\
\hline
$J_5$ & 16 & 60 & 4 & 0 & 3 & 8 \\
\hline
\end{tabular}
\label{tab:task_esercizio3}
\end{table}


\end{Esercizio4}



\begin{Esercizio5}

Si considerino i task periodici indicati in tabella, con deadline relativa inferiore 
al periodo. Ciascun task utilizza al massimo di 2 risorse critiche protette 
rispettivamente dai semafori $S_1$ ed $S_2$ per i quali si riporta la durata massima 
delle sezioni critiche per ogni task. Supponendo che i task siano schedulati con 
algoritmo EDF e le risorse gestite con SRP, si verifichi la fattibilità dell'insieme 
dei task adottando il metodo del \textit{processor demand criterion}. Il calcolo dei 
tempi di bloccaggio può essere fatto con lo stesso metodo che si utilizza per il 
protocollo di priority ceiling.

\begin{table}[h]
\centering
\begin{tabular}{|c|c|c|c|c|c|}
\hline
$\tau$ & $C_i$ & $D_i$ & $T_i$ & $S_1$ & $S_2$ \\
\hline
$\tau_1$ & 4 & 6 & 20 & 0 & 0 \\
\hline
$\tau_2$ & 1 & 3 & 4 & 1 & 0 \\
\hline
$\tau_3$ & 2 & 8 & 10 & 0 & 2 \\
\hline
$\tau_4$ & 1 & 7 & 8 & 1 & 1 \\
\hline
\end{tabular}
\label{tab:task_edf_srp}
\end{table}

\end{Esercizio5}